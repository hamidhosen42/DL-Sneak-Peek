# সফটম্যাক্স ফাংশন

এখানে আমরা দেখব সফটম্যাক্স ফাংশন কি? এটা পাইথনে কিভাবে ইমপ্লিমেন্ট করা যায় । এবং এটা কেন ব্যবহার করা হয় । 

## সফটম্যাক্স ফাংশন কি ? 
এটা এমন একটা ফাংশন যেটা যেকোনো [বাস্তব সংখ্যা  (Real number)](https://en.wikipedia.org/wiki/Real_number) কে প্রবাবিলিটি তে পরিবর্তন করতে পারে । এবং এটা মেশিন লার্নিং বা ডিপ লার্নিং এর জন্য খুবই গুরুত্বপূর্ণ । সফটম্যাক্স ফাংশন এর পেছনের ম্যাথমেটিক্স টা খুব সাধারণ । মনে করে আপনার কাছে কিছু বাস্তব সংখ্যা আছে । এখন এই ফাংশন যেটা করবে,

1. প্রতিটি বাস্তব সংখ্যার জন্য সে [$e^{number}$](https://en.wikipedia.org/wiki/Real_number) হিসাব করবে ।
2. সবগুলো $e^{number}$ কে যোগ করা। এই যোগ ফলের নাম দিলাম denominator বা হর (গাণিতিক ভাবে এই রকম লেখা যায়,  $\sum_{j=1}^{n} e^{x_j}$)
3. প্রত্যেক সংখ্যার জন্য সে exponential হিসাব করবে এবং এটা নাম দিলাম numerator বা লব । (গাণিতিক ভাবে এই রকম লেখা যায় $e^{x_i}$) 
4. তাহলে প্রবাবিলিতি হবে, $Probability=\frac{Numerator}{Denominator}$

এই ৪ টা ধপ যদি আমরা গণিতের ভাষায় প্রকাশ করতে চাই তাহলে আমাদের যদি n সংখ্যক বাস্তব সংখ্যা $x_1, x_2, ... , x_n$ থাকে তাহলে আমদের সফটম্যাক্স ফাংশন n সংখ্যক বাস্তব সংখ্যা কে এই সমীকরণ দিয়ে পরিবর্তন করে ফেলবে, 

\begin{equation*}
s(x_i) = \frac{e^{x_i}}{\sum_{j=1}^{n} e^{x_j}}
\end{equation*}

আমরা যদি n সংখ্যক বাস্তব সংখ্যার উপর এই ফাংশন এপলাই করি তাহলে আমরা নতুন যে n সংখ্যক সংখ্যা পাব তার সব গুলো সংখ্যা ০ থেকে ১ এর মধ্যে থাকবে । এবং n সংখ্যক সংখ্যার যোগফল অবশ্যই ১ হবে । যার ফলে সফটম্যাক্স ফাংশন n সংখ্যক সংখ্যা নিয়ে একটা [probability distribution](https://en.wikipedia.org/wiki/Probability_distribution) গঠন করে । 

## উপরের পুরা বিষয়টা একটা উদাহরণ দিয়ে দেখা যাক 
মনে করেন আমাদের ৪ টা সংখ্যা আছে । সংখ্যা গুলো, -1, 0, 3, এবং 5 । উপরে ধাপ অনুসারে আমরা প্রথমে denominator হিসাব করব এই ভাবে, 
\begin{equation*}
Denominator = e^{-1} + e^0 + e^3 + e^5 = 169.87
\end{equation*}
এটা ব্যবহার করে আমরা প্রত্যেক সংখ্যার জন্য numerators এবং probabilities হিসাব করতে পারি নিচের মতো করে । 


*x*| *Numerator( $e^x$ )* | *Probability( $\frac{e^x}{169.87}$* )
-- |--------------------- |---------------------------------
-1 | 0.368                | 0.002
0  | 1                    | 0.006
3  | 20.09                | 0.118
5  | 148.41               | 0.874
 - | -                    | Total = 1
 
উপরের টেবিল থেকে ২ টা বিষয় লক্ষণীয়,

1. `x এর মান যত বড় তার প্রবাবিলিটি ও ততো বেশি`
2. `৪ টা সংখ্যার প্রবাবিলিটি যোগ করলে যোগফল ১ হয়।` 

## পাইথন দিয়ে সফটম্যাক্স ফাংশন ইমপ্লিমেন্ট করা 

আমরা যদি [numpy](https://numpy.org/) ব্যবহার করি তাহলে খুব সহজেই এই কাজটা করা যায়,
```python
import numpy as np

def softmax(x):
    return np.exp(x) / sum(np.exp(x))

x_real_numbers = np.array([-1, 0, 3, 5])
print(softmax(x_real_numbers)) 
# Output: [0.0021657, 0.00588697, 0.11824302, 0.87370431]
```

## সফটম্যাক্স ফাংশন কেন দরকারি
মনে করেন আমরা একটা [Neural Network](https://victorzhou.com/blog/intro-to-neural-networks/) বানাতে চাই যার কাজ আমরা যদি তাকে বিড়াল বা কুকুরের ছবি দেখায় তাহলে সে বলে দিবে এটা বিড়ালের ছবি না কুকুরের ছবি । 
এই ধরনের সমস্যা সমাধানের জন্য জন্য নআমাদের কে এমন ভাবে নিউরাল নেটওয়ার্ক ডিজাইন করতে হবে যাতে করে নেটওয়ার্ক ২ টা বাস্তব সংখ্যা অউটপুট দেয় । যায় একটা সংখ্যা বিড়াল কে রিপ্রেজেন্ট করবে অন্য সংখ্যাটা কুকুর কে রিপ্রেজেন্ট করবে । এবং এই দুইটা সংখ্যার উপর আমরা সফটম্যাক্স ফাংশন এপলাই করব । 

মনে করেন আমাদের নিউরাল নেটওয়ার্ক [-1, 2]  এই দুইটা সংখ্যা অউতপুট দিছে । প্রথম সংখ্যা টা কুকুরের জন্য ২য় সংখ্যা টা বিড়ালের জন্য । এখন আমরা যদি এই সংখ্যার উপর সফটম্যাক্স ফাংশন এপলাই করি তাহলে, 

নাম   | x  | $e^x$ | Probability
-----|----|-------|------------
কুকুর  | -1 | 0.368 | 0.047
বিড়াল | 2  | 7.39  |  0.953

অর্থাৎ আমাদের নিউরাল নেটওয়ার্ক 95.3% নিশ্চিত যে, যে ছবি ইনপুট দেয়া হইছে সেটা বিড়ালের ছবি । সুতরাং সফটম্যাক্স ফাংশন আমাদের বলে দিচ্ছে আমার নেটওয়ার্ক কতটা নিশ্চিত ও তার সম্ভবতা কত । এই ধারনা শুধুমাত্র বাস্তব সংখ্যা দেখে বোঝা সম্ভব না ।  